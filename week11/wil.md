# <초급 백엔드 스터디 11주차 WIL>  

## 트러블 슈팅  
    - Koyeb에서 배포를 시도할 때 에러가 떠서 계속 실패했는데, 짐작가는 원인이 하나 있었다. 지금까지 과제를 github에 올릴 때, 브랜치를 나누지 않고 한 브랜치에 week1, ..., week10 이런 식으로 폴더가 몰아 넣어져 있었는데, 각 week마다 todo-api 프로젝트가 하나씩 있다 보니, Koyeb이 연결된 github 프로젝트의 브랜치에서 어떤 자바 어플리케이션 프로젝트를 가져와서 배포해야 될 지 애매한 에러가 발생했던 것 같다. 원인이 짐작이 가니 해결 방법도 바로 떠올랐다. 브랜치를 나눠서 거기에 todo-api 자바 프로젝트를 하나만 업로드했고, 그것을 Koyeb에 연결시켰더니 정상적으로 작동한 것 같다. 이 에러를 해결한 지 시간이 꽤 지난 상태에서 기억에 의존해서 작성하는 거라 여기서 다른 에러가 더 떴는지 기억이 나지 않는데, 가장 해결하는 데 애먹었던 에러는 이것이었던 것 같다.  

## 강의록
    - week11에 있는 강의록 참고  

## 키워드  
    - API 문서화, 프로젝트 배포  

### 1. API 문서화  
    - 백엔드가 만든 API에 대한 사용법을 문서로 공유하는 것  
    - 프론트엔드와 협업할 때 API 문서를 공유함  
    - API 문서화 과정  
        1. spring doc을 이용해서 OpenAPI 규격으로 API 문서 생성(OpenAPI : 표준 API 문서 규격)  
        2. Swagger-ui를 사용하여 spring doc이 생성한 API 문서에 swagger 디자인 적용(swagger 이외에도 다양한 API 문서화 도구가 있음)  
    - API 문서화 과정(실제 적용)  
        - Spring doc 의존성을 추가한다(build.gradle 파일의 dependencies { } 안에 implementation 'org.springdoc:springdoc-openapi-starter-webmvc-ui:2.6.0' 추가)  
        - spring doc은 swagger-ui를 적용한 문서를 만들어준다, http://localhost:8080/swagger-ui/index.html 접속  
        - API 호출 시 필요한 정보를 알 수 있고, 요청을 보내볼 수도 있다.(POST /todo 등)  
        - @ApiResponse를 사용하여 상태 코드마다 설명을 적을 수 있다(컨트롤러 계층에서 어노테이션을 거는 듯하다)  

### 2. 프로젝트 배포
    - 누구나 인터넷을 통해 요청을 보낼 수 있도록 우리가 만든 서버를 인터넷에 연결된 서버 컴퓨터에서 24시간 실행시켜 두는 것  
    - 노트북도 설정만 잘 해주면 서버 컴퓨터로 쓸 수 있지만 서버 컴퓨터를 설정하고 관리하는 것은 매우 복잡함(네트워크 설정, 방화벽 설정, 컴퓨터 온도 관리, 모니터링 등)  
    - 그래서 보통 잘 관리되는 서버 컴퓨터를 빌려서 배포함  
    - 서버 컴퓨터에서 우리가 만든 어플리케이션을 어떻게 실행할 수 있을까?  
        - 시시때때로 변경되는 소스 코드를 매번 git으로 받아온 뒤 명령어로 실행하는 것은 어려움  
        - 따라서 어플리케이션을 하나의 파일로 실행할 수 있도록, 여러 소스코드를 합치는 빌드 과정을 거쳐 실행함  
    - 자바 어플리케이션 빌드 과정  
        - (터미널에?) ./gradlew build  
        - 어플리케이션을 빌드할 때는 모든 테스트가 통과돼야 함  
        - 레포지토리 테스트는 제거하고, 서비스 테스트는 통과하도록 수정(why?)  
        - 빌드 성공 시 하나의 실행 가능한 .jar 파일이 만들어진다.
        - (터미널에?) java -jar "jar파일명(경로 포함)"  
        - 예시 : java -jar build/libs/todo-api-0.0.1-SNAPSHOT.jar  
    - 프로젝트 배포 과정  
        1. 로컬에서 어플리케이션을 빌드하여 jar 파일을 만든다  
        2. Java가 설치된 서버 컴퓨터에 jar 파일을 옮겨 넣는다  
        3. 서버 컴퓨터에서 jar 파일을 실행한다  
    - 프로젝트 배포  
        - AWS, GCP와 같은 서비스를 통해 컴퓨터를 대여받을 수 있다. 대여받은 컴퓨터에 java를 설치하고 jar 파일을 옮겨서 실행하면 서버 컴퓨터에 스프링 서버를 실행할 수 있다.(멀리 떨어진 서버에 java를 어떻게 설치하고, jar 파일을 어떻게 옮길까?)  
        - Koyeb, Qoddi와 같은 서비스는 컴퓨터를 빌려줄 뿐만 아니라, 깃허브와 연동해서 빌드, 실행까지 자동화해준다.(실제로는 aws 인스턴스를 빌려서 배포하는 게 일반적이라고 한다)  
        - 실제 Koyeb에서의 배포 과정은 강의록 참고